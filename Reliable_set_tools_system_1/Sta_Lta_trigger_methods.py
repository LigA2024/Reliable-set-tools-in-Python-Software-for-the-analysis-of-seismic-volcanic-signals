# -*- coding: utf-8 -*-

# Created by: PyQt5 UI code generator 5.15.2 and modified by later code editing
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.

# Developed by: Ligdamis A. Gutiérrez E. PhD.
# Seismic Analysis System

# Department of Theoretical Physics and the Cosmos,
# Science Faculty,
# Andalusian Institute of Geophysics.
# Granada University, (Ugr), Spain, 2021 - 2023

''' WARNING: Do not modify or edit the code without permission of the author.
    In case of using this software, indicate and refer to the author and the institution he represents.
    The University of Granada, Ugr '''

# Program:  Module 3 - Sta_Lta_trigger_methods.py -> STA/LTA trigger methods - New Version 1.1
# updated from previous version 1.0

# Interface, for STA/LTA trigger methods with filters.

# Load libraries to use

# Identify the operating system
import platform
sistema = platform.system()     # Identify the operating system

from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QApplication, QWidget, QMessageBox

# For system usage, threads and routes (path)
import sys
import os
import subprocess
from pathlib import Path

# To read records through the "obspy" library
import obspy
from obspy.imaging.cm import obspy_sequential
from obspy.signal.tf_misfit import cwt
from obspy import Stream

# Libraries to use tkinter (Graphical interface)
import tkinter
import tkinter as tk
from tkinter.ttk import Combobox, Style
from tkinter import Frame, IntVar, Label, filedialog, Entry, Radiobutton, CURRENT
# En caso de utilizar la ventana como root (cambios a posteriori)
from tkinter import *
root = tk.Tk()
root.withdraw()

# Libraries for graphics using matplotlib and using numpy, plotly
import numpy as np
from numpy.lib import format
import matplotlib.pyplot as plt
import plotly.graph_objects as go

import shutil
import io
import pickle

from obspy import UTCDateTime

from obspy.core.util import get_example_file
from obspy.signal.trigger import recursive_sta_lta, plot_trigger, trigger_onset
from obspy.signal.trigger import classic_sta_lta, trigger_onset, plot_trigger

# Main Class of Program Ui_MainWindow, Object: MainWindow

from PyQt5 import QtCore, QtGui, QtWidgets


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.setWindowModality(QtCore.Qt.WindowModal)
        MainWindow.resize(954, 377)
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap("Images/Ugr.gif"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        MainWindow.setWindowIcon(icon)
        MainWindow.setToolTip("")

        # Set frame group 2

        self.frame_2 = QtWidgets.QFrame(MainWindow)
        self.frame_2.setGeometry(QtCore.QRect(10, 10, 931, 141))
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(216, 225, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(216, 225, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(216, 225, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.Window, brush)
        self.frame_2.setPalette(palette)
        self.frame_2.setAutoFillBackground(True)
        self.frame_2.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.frame_2.setFrameShadow(QtWidgets.QFrame.Raised)
        self.frame_2.setObjectName("frame_2")

        self.pushButton = QtWidgets.QPushButton(self.frame_2)
        self.pushButton.setGeometry(QtCore.QRect(20, 20, 91, 31))
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.Button, brush)
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(240, 240, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.Button, brush)
        brush = QtGui.QBrush(QtGui.QColor(240, 240, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(240, 240, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.Button, brush)
        brush = QtGui.QBrush(QtGui.QColor(240, 240, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.Window, brush)
        self.pushButton.setPalette(palette)
        self.pushButton.setAutoFillBackground(True)
        icon1 = QtGui.QIcon()
        icon1.addPixmap(QtGui.QPixmap("Images/Load.gif"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.pushButton.setIcon(icon1)
        self.pushButton.setObjectName("pushButton")

        """ --- Values for Text Boxes (lineEdit) --- """

        self.lineEdit = QtWidgets.QLineEdit(self.frame_2)                       # STA Text box.
        self.lineEdit.setGeometry(QtCore.QRect(560, 80, 61, 20))
        self.lineEdit.setInputMethodHints(QtCore.Qt.ImhPreferNumbers)
        self.lineEdit.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEdit.setObjectName("lineEdit")

        self.lineEdit_2 = QtWidgets.QLineEdit(self.frame_2)                     # LTA Text box.
        self.lineEdit_2.setGeometry(QtCore.QRect(560, 110, 61, 20))
        self.lineEdit_2.setInputMethodHints(QtCore.Qt.ImhPreferNumbers)
        self.lineEdit_2.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEdit_2.setObjectName("lineEdit_2")

        self.lineEdit_3 = QtWidgets.QLineEdit(self.frame_2)                     # ThrOn Text box.
        self.lineEdit_3.setGeometry(QtCore.QRect(690, 80, 61, 20))
        self.lineEdit_3.setInputMethodHints(QtCore.Qt.ImhPreferNumbers)
        self.lineEdit_3.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEdit_3.setObjectName("lineEdit_3")

        self.lineEdit_4 = QtWidgets.QLineEdit(self.frame_2)                     # ThrOff Text box.
        self.lineEdit_4.setGeometry(QtCore.QRect(690, 110, 61, 20))
        self.lineEdit_4.setInputMethodHints(QtCore.Qt.ImhPreferNumbers)
        self.lineEdit_4.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEdit_4.setObjectName("lineEdit_4")

        self.lineEdit_5 = QtWidgets.QLineEdit(self.frame_2)                     # Trace No. st[0] Text box.
        self.lineEdit_5.setGeometry(QtCore.QRect(870, 110, 41, 21))
        self.lineEdit_5.setInputMethodHints(QtCore.Qt.ImhPreferNumbers)
        self.lineEdit_5.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEdit_5.setObjectName("lineEdit_5")

        self.lineEdit_6 = QtWidgets.QLineEdit(self.frame_2)                     # Frecuency Text box.
        self.lineEdit_6.setGeometry(QtCore.QRect(360, 40, 61, 20))
        self.lineEdit_6.setInputMethodHints(QtCore.Qt.ImhPreferNumbers)
        self.lineEdit_6.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEdit_6.setObjectName("lineEdit_6")

        self.lineEdit_7 = QtWidgets.QLineEdit(self.frame_2)                     # Min Frecuency Text box.
        self.lineEdit_7.setGeometry(QtCore.QRect(450, 80, 61, 20))
        self.lineEdit_7.setInputMethodHints(QtCore.Qt.ImhPreferNumbers)
        self.lineEdit_7.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEdit_7.setObjectName("lineEdit_7")

        self.lineEdit_8 = QtWidgets.QLineEdit(self.frame_2)                     # Max Frecuency Text box.
        self.lineEdit_8.setGeometry(QtCore.QRect(450, 110, 61, 20))
        self.lineEdit_8.setInputMethodHints(QtCore.Qt.ImhPreferNumbers)
        self.lineEdit_8.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEdit_8.setObjectName("lineEdit_8")

        self.lineEdit_9 = QtWidgets.QLineEdit(self.frame_2)                     # Filter order Text box.
        self.lineEdit_9.setGeometry(QtCore.QRect(450, 40, 61, 20))
        self.lineEdit_9.setInputMethodHints(QtCore.Qt.ImhPreferNumbers)
        self.lineEdit_9.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEdit_9.setObjectName("lineEdit_9")


        self.label_4 = QtWidgets.QLabel(self.frame_2)
        self.label_4.setGeometry(QtCore.QRect(520, 0, 221, 21))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        self.label_4.setFont(font)
        self.label_4.setObjectName("label_4")

        self.label_5 = QtWidgets.QLabel(self.frame_2)
        self.label_5.setGeometry(QtCore.QRect(520, 80, 41, 16))
        self.label_5.setObjectName("label_5")

        self.label_6 = QtWidgets.QLabel(self.frame_2)
        self.label_6.setGeometry(QtCore.QRect(520, 110, 41, 16))
        self.label_6.setObjectName("label_6")

        self.label_9 = QtWidgets.QLabel(self.frame_2)
        self.label_9.setGeometry(QtCore.QRect(540, 20, 231, 16))
        self.label_9.setObjectName("label_9")

        self.label_11 = QtWidgets.QLabel(self.frame_2)
        self.label_11.setGeometry(QtCore.QRect(540, 40, 231, 16))
        self.label_11.setObjectName("label_11")

        self.label_12 = QtWidgets.QLabel(self.frame_2)
        self.label_12.setGeometry(QtCore.QRect(810, 10, 91, 81))
        self.label_12.setText("")
        self.label_12.setPixmap(QtGui.QPixmap("Images/Ugr.gif"))
        self.label_12.setScaledContents(True)
        self.label_12.setObjectName("label_12")

        self.label_13 = QtWidgets.QLabel(self.frame_2)
        self.label_13.setGeometry(QtCore.QRect(640, 110, 51, 16))
        self.label_13.setObjectName("label_13")

        self.label_15 = QtWidgets.QLabel(self.frame_2)
        self.label_15.setGeometry(QtCore.QRect(650, 80, 41, 16))
        self.label_15.setObjectName("label_15")

        self.label_16 = QtWidgets.QLabel(self.frame_2)
        self.label_16.setGeometry(QtCore.QRect(780, 100, 81, 20))
        self.label_16.setObjectName("label_16")

        self.label_17 = QtWidgets.QLabel(self.frame_2)
        self.label_17.setGeometry(QtCore.QRect(790, 120, 71, 16))
        font = QtGui.QFont()
        font.setPointSize(7)
        self.label_17.setFont(font)
        self.label_17.setObjectName("label_17")

        self.label_18 = QtWidgets.QLabel(self.frame_2)
        self.label_18.setGeometry(QtCore.QRect(450, 20, 61, 16))
        font = QtGui.QFont()
        font.setPointSize(7)
        self.label_18.setFont(font)
        self.label_18.setObjectName("label_18")

        self.label_19 = QtWidgets.QLabel(self.frame_2)
        self.label_19.setGeometry(QtCore.QRect(440, 10, 71, 16))
        self.label_19.setObjectName("label_19")

        self.label_20 = QtWidgets.QLabel(self.frame_2)
        self.label_20.setGeometry(QtCore.QRect(350, 110, 91, 16))
        self.label_20.setObjectName("label_20")

        self.label_21 = QtWidgets.QLabel(self.frame_2)
        self.label_21.setGeometry(QtCore.QRect(350, 80, 91, 16))
        self.label_21.setObjectName("label_21")

        self.label_22 = QtWidgets.QLabel(self.frame_2)
        self.label_22.setGeometry(QtCore.QRect(356, 10, 81, 16))
        self.label_22.setObjectName("label_22")


        """ --- Values for the separation lines on the canvas (line) --- """

        self.line = QtWidgets.QFrame(self.frame_2)
        self.line.setGeometry(QtCore.QRect(340, 0, 20, 141))
        self.line.setFrameShape(QtWidgets.QFrame.VLine)
        self.line.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line.setObjectName("line")

        self.line_2 = QtWidgets.QFrame(self.frame_2)
        self.line_2.setGeometry(QtCore.QRect(760, 0, 20, 141))
        self.line_2.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_2.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_2.setObjectName("line_2")

        self.line_3 = QtWidgets.QFrame(self.frame_2)
        self.line_3.setGeometry(QtCore.QRect(110, 0, 20, 141))
        self.line_3.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_3.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_3.setObjectName("line_3")

        self.line_4 = QtWidgets.QFrame(self.frame_2)
        self.line_4.setGeometry(QtCore.QRect(0, 60, 121, 16))
        self.line_4.setFrameShape(QtWidgets.QFrame.HLine)
        self.line_4.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_4.setObjectName("line_4")

        self.line_6 = QtWidgets.QFrame(self.frame_2)
        self.line_6.setGeometry(QtCore.QRect(630, 70, 20, 71))
        self.line_6.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_6.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_6.setObjectName("line_6")

        self.line_11 = QtWidgets.QFrame(self.frame_2)
        self.line_11.setGeometry(QtCore.QRect(920, 0, 20, 141))
        self.line_11.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_11.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_11.setObjectName("line_11")

        self.line_12 = QtWidgets.QFrame(self.frame_2)
        self.line_12.setGeometry(QtCore.QRect(350, 60, 421, 20))
        self.line_12.setFrameShape(QtWidgets.QFrame.HLine)
        self.line_12.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_12.setObjectName("line_12")

        self.line_17 = QtWidgets.QFrame(self.frame_2)
        self.line_17.setGeometry(QtCore.QRect(510, 70, 20, 71))
        self.line_17.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_17.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_17.setObjectName("line_17")

        self.line_18 = QtWidgets.QFrame(self.frame_2)
        self.line_18.setGeometry(QtCore.QRect(510, 0, 20, 71))
        self.line_18.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_18.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_18.setObjectName("line_18")

        self.line_19 = QtWidgets.QFrame(self.frame_2)
        self.line_19.setGeometry(QtCore.QRect(430, 0, 20, 71))
        self.line_19.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_19.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_19.setObjectName("line_19")


        self.pushButton_2 = QtWidgets.QPushButton(self.frame_2)
        self.pushButton_2.setGeometry(QtCore.QRect(20, 90, 91, 31))
        icon2 = QtGui.QIcon()
        icon2.addPixmap(QtGui.QPixmap("Images/Clean.gif"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.pushButton_2.setIcon(icon2)
        self.pushButton_2.setObjectName("pushButton_2")

        self.groupBox_2 = QtWidgets.QGroupBox(self.frame_2)
        self.groupBox_2.setGeometry(QtCore.QRect(130, 10, 211, 101))
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(240, 255, 247))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(240, 255, 247))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(240, 255, 247))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.Window, brush)
        self.groupBox_2.setPalette(palette)
        self.groupBox_2.setAutoFillBackground(True)
        self.groupBox_2.setObjectName("groupBox_2")

        self.comboBox_2 = QtWidgets.QComboBox(self.groupBox_2)
        self.comboBox_2.setGeometry(QtCore.QRect(10, 20, 191, 22))
        self.comboBox_2.setObjectName("comboBox_2")
        self.comboBox_2.addItem("")
        self.comboBox_2.addItem("")
        self.comboBox_2.addItem("")
        self.comboBox_2.addItem("")
        self.comboBox_2.addItem("")


        self.label_3 = QtWidgets.QLabel(MainWindow)
        self.label_3.setGeometry(QtCore.QRect(50, 150, 151, 41))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(36)
        font.setBold(True)
        font.setItalic(True)
        font.setWeight(75)
        self.label_3.setFont(font)
        self.label_3.setObjectName("label_3")

        # Set frame group 3

        self.frame_3 = QtWidgets.QFrame(MainWindow)
        self.frame_3.setGeometry(QtCore.QRect(10, 300, 931, 61))
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(255, 254, 219))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(255, 254, 219))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(255, 254, 219))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.Window, brush)
        self.frame_3.setPalette(palette)
        self.frame_3.setAutoFillBackground(True)
        self.frame_3.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.frame_3.setFrameShadow(QtWidgets.QFrame.Raised)
        self.frame_3.setObjectName("frame_3")


        """ --- Values for Text Labels (Label)  --- """

        self.label_2 = QtWidgets.QLabel(self.frame_3)
        self.label_2.setGeometry(QtCore.QRect(170, 20, 581, 31))
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.Base, brush)
        brush = QtGui.QBrush(QtGui.QColor(216, 225, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.Base, brush)
        brush = QtGui.QBrush(QtGui.QColor(216, 225, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.Window, brush)
        brush = QtGui.QBrush(QtGui.QColor(216, 225, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.Base, brush)
        brush = QtGui.QBrush(QtGui.QColor(216, 225, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.Window, brush)
        self.label_2.setPalette(palette)
        self.label_2.setFocusPolicy(QtCore.Qt.StrongFocus)
        self.label_2.setAutoFillBackground(True)
        self.label_2.setText("")
        self.label_2.setObjectName("label_2")

        self.label = QtWidgets.QLabel(self.frame_3)
        self.label.setGeometry(QtCore.QRect(160, 0, 191, 21))
        self.label.setObjectName("label")

        self.line_5 = QtWidgets.QFrame(self.frame_3)
        self.line_5.setGeometry(QtCore.QRect(150, 0, 3, 61))
        self.line_5.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_5.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_5.setObjectName("line_5")

        self.line_7 = QtWidgets.QFrame(self.frame_3)
        self.line_7.setGeometry(QtCore.QRect(770, 0, 3, 61))
        self.line_7.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_7.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_7.setObjectName("line_7")

        self.line_10 = QtWidgets.QFrame(self.frame_3)
        self.line_10.setGeometry(QtCore.QRect(920, 0, 16, 61))
        self.line_10.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_10.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_10.setObjectName("line_10")

        self.pushButton_8 = QtWidgets.QPushButton(self.frame_3)
        self.pushButton_8.setGeometry(QtCore.QRect(800, 10, 101, 41))
        icon3 = QtGui.QIcon()
        icon3.addPixmap(QtGui.QPixmap("Images/Exit.gif"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.pushButton_8.setIcon(icon3)
        self.pushButton_8.setObjectName("pushButton_8")

        self.pushButton_7 = QtWidgets.QPushButton(self.frame_3)
        self.pushButton_7.setGeometry(QtCore.QRect(20, 10, 101, 41))
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(240, 240, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.Button, brush)
        brush = QtGui.QBrush(QtGui.QColor(240, 240, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.Button, brush)
        brush = QtGui.QBrush(QtGui.QColor(240, 240, 240))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.Button, brush)
        self.pushButton_7.setPalette(palette)
        self.pushButton_7.setAutoFillBackground(True)
        icon4 = QtGui.QIcon()
        icon4.addPixmap(QtGui.QPixmap("Images/Back.gif"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.pushButton_7.setIcon(icon4)
        self.pushButton_7.setObjectName("pushButton_7")

        # Set frame group

        self.frame = QtWidgets.QFrame(MainWindow)
        self.frame.setGeometry(QtCore.QRect(220, 160, 721, 101))
        self.frame.setAutoFillBackground(True)
        self.frame.setFrameShape(QtWidgets.QFrame.Box)
        self.frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.frame.setObjectName("frame")

        self.label_7 = QtWidgets.QLabel(self.frame)
        self.label_7.setGeometry(QtCore.QRect(200, 10, 341, 71))
        self.label_7.setObjectName("label_7")

        self.label_14 = QtWidgets.QLabel(self.frame)
        self.label_14.setGeometry(QtCore.QRect(24, 10, 161, 16))
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(0, 0, 127))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.WindowText, brush)
        brush = QtGui.QBrush(QtGui.QColor(0, 0, 127))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.WindowText, brush)
        brush = QtGui.QBrush(QtGui.QColor(120, 120, 120))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.WindowText, brush)
        self.label_14.setPalette(palette)
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setPointSize(7)
        font.setBold(True)
        font.setWeight(75)
        self.label_14.setFont(font)
        self.label_14.setObjectName("label_14")

        self.line_15 = QtWidgets.QFrame(self.frame)
        self.line_15.setGeometry(QtCore.QRect(170, 0, 16, 101))
        self.line_15.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_15.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_15.setObjectName("line_15")

        self.line_16 = QtWidgets.QFrame(self.frame)
        self.line_16.setGeometry(QtCore.QRect(550, 0, 20, 101))
        self.line_16.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_16.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_16.setObjectName("line_16")

        self.radioButton = QtWidgets.QRadioButton(self.frame)
        self.radioButton.setGeometry(QtCore.QRect(50, 40, 82, 17))
        self.radioButton.setChecked(True)
        self.radioButton.setObjectName("radioButton")

        self.radioButton_2 = QtWidgets.QRadioButton(self.frame)
        self.radioButton_2.setGeometry(QtCore.QRect(50, 70, 82, 17))
        self.radioButton_2.setObjectName("radioButton_2")

        self.pushButton_5 = QtWidgets.QPushButton(self.frame)
        self.pushButton_5.setGeometry(QtCore.QRect(600, 30, 101, 41))
        icon5 = QtGui.QIcon()
        icon5.addPixmap(QtGui.QPixmap("Images/sta.gif"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.pushButton_5.setIcon(icon5)
        self.pushButton_5.setObjectName("pushButton_5")

        self.line_8 = QtWidgets.QFrame(MainWindow)
        self.line_8.setGeometry(QtCore.QRect(10, 260, 271, 20))
        self.line_8.setFrameShape(QtWidgets.QFrame.HLine)
        self.line_8.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_8.setObjectName("line_8")

        self.line_9 = QtWidgets.QFrame(MainWindow)
        self.line_9.setGeometry(QtCore.QRect(10, 280, 931, 16))
        self.line_9.setFrameShape(QtWidgets.QFrame.HLine)
        self.line_9.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_9.setObjectName("line_9")

        self.label_8 = QtWidgets.QLabel(MainWindow)
        self.label_8.setGeometry(QtCore.QRect(360, 260, 191, 31))
        font = QtGui.QFont()
        font.setFamily("Times New Roman")
        font.setPointSize(30)
        font.setBold(True)
        font.setItalic(True)
        font.setWeight(75)
        self.label_8.setFont(font)
        self.label_8.setObjectName("label_8")

        self.line_13 = QtWidgets.QFrame(MainWindow)
        self.line_13.setGeometry(QtCore.QRect(600, 260, 341, 20))
        self.line_13.setFrameShape(QtWidgets.QFrame.HLine)
        self.line_13.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_13.setObjectName("line_13")

        self.line_14 = QtWidgets.QFrame(MainWindow)
        self.line_14.setGeometry(QtCore.QRect(0, 10, 20, 141))
        self.line_14.setFrameShape(QtWidgets.QFrame.VLine)
        self.line_14.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_14.setObjectName("line_14")

        self.label_10 = QtWidgets.QLabel(MainWindow)
        self.label_10.setGeometry(QtCore.QRect(60, 180, 111, 81))
        self.label_10.setText("")
        self.label_10.setPixmap(QtGui.QPixmap("Images/IAG.gif"))
        self.label_10.setScaledContents(True)
        self.label_10.setObjectName("label_10")

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

        # Color and text formatting on Command Buttons
        self.pushButton.setStyleSheet("background-color: honeydew; color: blue")            # Text and Color of the Command Button (load File)
        self.pushButton_2.setStyleSheet("background-color: ivory; color: blue")             # Text and Color of the Command Button (clean input)
        self.pushButton_5.setStyleSheet("background-color: lightblue; color: black")        # Text and Color of the Command Button (plot)
        self.pushButton_7.setStyleSheet("background-color: CornflowerBlue; color: white")   # Text and Color of the Command Button (Back)
        self.pushButton_8.setStyleSheet("background-color: wheat; color: blue")             # Text and Color of the Command Button (Exit)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "Trigger Methods STA/LTA (V.1.1) - University of Granada (Ugr)"))
        self.pushButton.setToolTip(_translate("MainWindow", "<html><head/><body><p><span style=\" font-weight:600; color:#00007f;\">Load Record</span></p></body></html>"))
        self.pushButton.setText(_translate("MainWindow", " Load Record"))
        self.label_4.setText(_translate("MainWindow", "<html><head/><body><p align=\"center\"><span style=\" font-size:9pt; font-weight:600; color:#aa5500;\">Initial and final Values</span></p></body></html>"))
        self.label_5.setText(_translate("MainWindow", "<html><head/><body><p align=\"center\"><span style=\" font-size:7pt; font-weight:600; color:#aa5500;\">STA</span></p></body></html>"))
        self.label_6.setText(_translate("MainWindow", "<html><head/><body><p align=\"center\"><span style=\" font-size:7pt; font-weight:600; color:#aa5500;\">LTA</span></p></body></html>"))
        self.label_13.setText(_translate("MainWindow", "<html><head/><body><p align=\"center\"><span style=\" font-weight:600; color:#aa5500;\">ThrOff</span></p></body></html>"))
        self.label_15.setText(_translate("MainWindow", "<html><head/><body><p><span style=\" font-weight:600; color:#aa0000;\">ThrOn</span></p></body></html>"))
        self.pushButton_2.setToolTip(_translate("MainWindow", "<html><head/><body><p><span style=\" font-weight:600; color:#00007f;\">Clear Inputs</span></p></body></html>"))
        self.pushButton_2.setText(_translate("MainWindow", " Clean Inputs"))
        self.groupBox_2.setTitle(_translate("MainWindow", "Filter type"))
        self.comboBox_2.setItemText(0, _translate("MainWindow", "Please select"))
        self.comboBox_2.setItemText(1, _translate("MainWindow", "Lowpass"))
        self.comboBox_2.setItemText(2, _translate("MainWindow", "Highpass"))
        self.comboBox_2.setItemText(3, _translate("MainWindow", "Bandpass"))
        self.comboBox_2.setItemText(4, _translate("MainWindow", "Bandstop"))
        self.label_9.setText(_translate("MainWindow", "ThrOn: Cutoff ratio to activate STA/LTA"))
        self.label_11.setText(_translate("MainWindow", "ThrOff: Cutoff ratio to end STA/LTA"))

        self.label_16.setText(_translate("MainWindow", "<html><head/><body><p><span style=\" font-size:6pt; font-weight:600; color:#610000;\">Trace number st(n):</span></p></body></html>"))
        self.label_17.setText(_translate("MainWindow", "<html><head/><body><p><span style=\" font-size:6pt; font-weight:600; font-style:italic; color:#00007f;\">By default: st(0)</span></p></body></html>"))
        self.label_20.setText(_translate("MainWindow", "<html><head/><body><p align=\"center\"><span style=\" font-size:7pt; font-weight:600; font-style:italic; color:#aa5500;\">Frec Max (Hz):</span></p></body></html>"))
        self.label_21.setText(_translate("MainWindow", "<html><head/><body><p align=\"center\"><span style=\" font-size:7pt; font-weight:600; font-style:italic; color:#aa5500;\">Frec Min (Hz):</span></p></body></html>"))
        self.label_19.setText(_translate("MainWindow", "<html><head/><body><p align=\"center\"><span style=\" font-size:7pt; font-weight:600; font-style:italic; color:#aa5500;\">Filter Order</span></p></body></html>"))
        self.label_22.setText(_translate("MainWindow", "<html><head/><body><p><span style=\" font-size:7pt; font-weight:600; color:#0055ff;\">Frecuency (Hz)</span></p></body></html>"))
        self.label_18.setText(_translate("MainWindow", "<html><head/><body><p><span style=\" font-size:6pt; font-weight:600; font-style:italic; color:#00007f;\">By default = 4</span></p></body></html>"))
        self.label_3.setText(_translate("MainWindow", "<html><head/><body><p><span style=\" font-size:12pt; color:#0000ff;\">Trigger STA/LTA</span></p></body></html>"))
        self.label.setText(_translate("MainWindow", "<html><head/><body><p align=\"center\"><span style=\" font-weight:600; font-style:italic; color:#0000ff;\">Seismic record path to upload: </span></p></body></html>"))
        self.pushButton_8.setToolTip(_translate("MainWindow", "<html><head/><body><p><span style=\" font-weight:600; color:#aa0000;\">Exit System</span></p></body></html>"))
        self.pushButton_8.setText(_translate("MainWindow", "  Exit"))
        self.pushButton_7.setToolTip(_translate("MainWindow", "<html><head/><body><p><span style=\" font-weight:600; color:#aa0000;\">Go Back</span></p></body></html>"))
        self.pushButton_7.setText(_translate("MainWindow", "  Go Back"))
        self.label_7.setText(_translate("MainWindow", "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"
"<html><head><meta name=\"qrichtext\" content=\"1\" /><style type=\"text/css\">\n"
"p, li { white-space: pre-wrap; }\n"
"</style></head><body style=\" font-family:\'MS Shell Dlg 2\'; font-size:8pt; font-weight:400; font-style:normal;\">\n"
"<p align=\"justify\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\" font-size:9pt; font-weight:600; font-style:italic; color:#00007f;\">The &quot;obspy&quot; library is used to read the seismic records, </span></p>\n"
"<p align=\"justify\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\" font-size:9pt; font-weight:600; font-style:italic; color:#00007f;\">The trigger routine is defined in obspy.signal.trigger. </span></p>\n"
"<p align=\"justify\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><span style=\" font-size:9pt; font-weight:600; font-style:italic; color:#00007f;\">The matplolib library is used for the graphs.</span></p></body></html>"))
        self.label_14.setText(_translate("MainWindow", "Available STA/LTA algorithms."))
        self.radioButton.setText(_translate("MainWindow", "Recursive"))
        self.radioButton_2.setText(_translate("MainWindow", "Classic"))
        self.pushButton_5.setToolTip(_translate("MainWindow", "<html><head/><body><p><span style=\" font-weight:600; color:#00007f;\">Record Plot </span></p></body></html>"))
        self.pushButton_5.setText(_translate("MainWindow", "  Plot"))
        self.label_8.setText(_translate("MainWindow", "<html><head/><body><p><span style=\" font-size:10pt; color:#aa0000;\">Action commands for the records</span></p></body></html>"))


        # Disable text boxes initially
        self.lineEdit.setEnabled(False)                 # Disable the STA Text box.
        self.lineEdit_2.setEnabled(False)               # Disable the LTA Text box.
        self.lineEdit_3.setEnabled(False)               # Disable the ThrOn Text box.
        self.lineEdit_4.setEnabled(False)               # Disable the ThrOff Text box.
        self.lineEdit_5.setEnabled(False)               # Disable Trace No. st[0] Text box.
        self.lineEdit_5.setText("0")                    # Initialize text box content of Trace Number st[0].
        self.lineEdit_6.setEnabled(False)               # Disable Frecuency Text box.
        self.lineEdit_7.setEnabled(False)               # Disable  Min Frecuency Text box.
        self.lineEdit_8.setEnabled(False)               # Disable  Max Frecuency Text box.
        self.lineEdit_9.setEnabled(False)               # Disable Filter order Text box.
        self.lineEdit_9.setText("4")                    # Initialize Filter order text box content = 4.

        self.pushButton_5.setEnabled(False)             # Disable the Graph button.

        # Command button actions, function calls
        self.pushButton.clicked.connect(self.cargar)                                        # Call the function to upload file (Load File).
        self.pushButton_2.clicked.connect(self.clean)                                       # Calls the function to clean entries (Clean Entries).
        self.pushButton_5.clicked.connect(self.verificar)                                   # Call the function to graph the records (Plot).
        self.pushButton_7.clicked.connect(self.return1)                                     # Call the function to return to the Home Screen (Back).
        self.pushButton_8.clicked.connect(self.Exit1)                                       # Call the function to exit the System (Exit).


        # Validar para que solo se acepten números decimales "QDoubleValidator": Para "enteros", hay que colocar "QIntValidator"
        self.lineEdit.setValidator(QtGui.QDoubleValidator())            # Solo acepta números en la caja de texto de STA
        self.lineEdit_2.setValidator(QtGui.QDoubleValidator())          # Solo acepta números en la caja de texto de LTA
        self.lineEdit_3.setValidator(QtGui.QDoubleValidator())          # Solo acepta números en la caja de texto de ThrOn
        self.lineEdit_4.setValidator(QtGui.QDoubleValidator())          # Solo acepta números en la caja de texto de ThrOff
        self.lineEdit_5.setValidator(QtGui.QIntValidator(1, 99))        # Solo acepta números en la caja de texto de Número de Traza ts[0] Valor dos digitos

        # Call to the function according to the ComboBox list for the Filter type
        self.comboBox_2.activated.connect(self.selection_changed1)


        # Se establece el orden de tabulación de las cajas de texto para el STA/LTA, (Debido a que fueron creadas en orden diferente)
        MainWindow.setTabOrder(self.lineEdit_7, self.lineEdit_8)        # Primero la Frecuencia, seguida de la Frecuencia mínima
        MainWindow.setTabOrder(self.lineEdit_6, self.lineEdit_9)        # Despues de la Frecuencia Máxima, seguido del orden de filtro


        """ ------------- Start of Program Functions  ------------ """

        """ Function to open and clean """

    """  Function to manage the filter combobox  """

    def selection_changed1(self):  # Function that programs the list of the ComboBox, for the Type of Filter

        index = self.comboBox_2.currentIndex()                      # According to the selection of the combo, its index is captured

        # Activation/Deactivation buttons for graphing
        self.pushButton_5.setEnabled(True)                          # Activate the Graph button for the integral of the signal.

        if (0 == index):                                            # In case the Combobox index is 0, "Select"
            self.activacion1()                                      # Call to the cleaning function and Activation/Deactivation

        elif (1 == index):                                          # In case the Combobox index is 1, Lowpass Filter
            self.activacion2()                                      # Call to the cleaning function and Activation/Deactivation

        elif (2 == index):                                          # In case the Combobox index is 2, Highpass Filter
            self.activacion2()                                      # Call to the cleaning function and Activation/Deactivation

        elif (3 == index):                                          # In case the Combobox index is 3, Bandpass Filter
            self.activacion3()                                      # Call to the cleaning function and Activation/Deactivation

        elif (4 == index):                                          # In case the Combobox index is 4, Bandstop Filter
            self.activacion3()                                      # Call to the cleaning function and Activation/Deactivation

        else:
            pass


    def cargar(self):                                       # Function, to search and load the records according to the format
        if sistema == "Windows":
            # Windows System
            self.archivo_abierto=filedialog.askopenfilename(initialdir = "/",
                title = "Please, select file",filetypes = (("All Files","*.*"),
                ('SAC Files","*.sac'),
                ('MSEED Files','*.mseed'),
                ('GSE2 Files','*.gse2'),
                ('WAV Files','*.wav'),
                ('NPY Files','*.npy'),
                ('EVT Files','*.evt')))

            self.ruta = Path(self.archivo_abierto)
            self.ruta2 = self.ruta.joinpath(self.ruta).resolve()


            font=QtGui.QFont()
            font.setFamily("Times New Roman")
            font.setPointSize(8)
            font.setBold(False)
            font.setItalic(False)
            font.setWeight(60)
            self.label_2.setFont(font)                      # Printing using text format.
            self.label_2.setText(self.archivo_abierto)      # Printing on the file path label.

            head, tail = os.path.split(self.archivo_abierto)
            root, extension = os.path.splitext(tail)

        else:
            # Linux System
            self.archivo_abierto=filedialog.askopenfilename(initialdir = "/",
                title = "Please, select file",filetypes = (("All Files","*.*"),
                ('SAC Files","*.sac'),
                ('MSEED Files','*.mseed'),
                ('GSE2 Files','*.gse2'),
                ('WAV Files','*.wav'),
                ('NPY Files','*.npy'),
                ('EVT Files','*.evt')))

            self.ruta = Path(self.archivo_abierto)
            self.ruta2 = self.ruta.joinpath(self.ruta).resolve()

            font=QtGui.QFont()
            font.setFamily("Times New Roman")
            font.setPointSize(8)
            font.setBold(False)
            font.setItalic(False)
            font.setWeight(60)
            self.label_2.setFont(font)                  # Printing using text format.
            self.label_2.setText(self.archivo_abierto)  # Printing on the file path label.

            return self

    def clean(self):                                    # Clean and leave everything as at the beginning.

        msg = QMessageBox()
        msg.setIcon(QMessageBox.Question)
        msg.setWindowTitle("Clean all inputs.")
        msg.setText("Are you sure to delete all entries?")
        msg.setStandardButtons(QMessageBox.Ok | QMessageBox.Cancel)
        msg.setDefaultButton(QMessageBox.Ok)                                    # By default, the focus is on the OK button
        returnValue = msg.exec()
        if returnValue == QMessageBox.Ok:                                       # If the answer is OK

            # Position the ComboBox at the start.
            self.comboBox_2.setCurrentIndex(0)              # Position in the first Item (Filter Type).
            plt.close()                                     # Close the existing chart.

            # Delete label content and Text Boxes.
            self.label_2.setText("")                        # Delete the contents of the File Path label

            self.lineEdit.setText("")                       # Clear the content of the STA text box.
            self.lineEdit_2.setText("")                     # Clear the content of the LTA text box.
            self.lineEdit_3.setText("")                     # Clear the content of the ThrOn text box.
            self.lineEdit_4.setText("")                     # Clear the content of the ThrOff text box.
            self.lineEdit_5.setText("0")                    # Initialize Nº de Trace st[0] text box.
            self.lineEdit_6.setText("")                     # Clear the content of the Frecuency text box.
            self.lineEdit_7.setText("")                     # Clear the content of the Min Frecuency text box.
            self.lineEdit_8.setText("")                     # Clear the content of the Max Frecuency text box.
            self.lineEdit_9.setText("4")                    # Initialize Filter order text box content = 4.

            # Disable text boxes.
            self.lineEdit.setEnabled(False)                 # Disables the minimum STA text box.
            self.lineEdit_2.setEnabled(False)               # Disables the minimum LTA text box.
            self.lineEdit_3.setEnabled(False)               # Disables the minimum ThrOn text box.
            self.lineEdit_4.setEnabled(False)               # Disables the minimum ThrOff text box.
            self.lineEdit_5.setEnabled(False)               # Disables the Nº de Trace st[0] text box.
            self.lineEdit_6.setEnabled(False)               # Disables the Frecuency text box.
            self.lineEdit_7.setEnabled(False)               # Disables the Min Frecuency text box.
            self.lineEdit_8.setEnabled(False)               # Disables the Max Frecuency text box.
            self.lineEdit_9.setEnabled(False)               # Disables the Filter order text box.

            self.radioButton.setChecked(True)               # Select recursive algorithm radiobutton

            self.pushButton_5.setEnabled(False)             # Disable the Graph button.

            plt.close()                                     # Close the existing chart.

        else:
            pass


    """ Function to handle the activation / deactivation of text boxes in filters  """


    def activacion1(self):                                              # To Activate / Deactivate and cleaning in "Selection" -> Index 0.

        plt.close()                                                     # Close the existing chart.

        # Clean entrances.
        self.lineEdit.setText("")                                       # Clear the content of the STA text box.
        self.lineEdit_2.setText("")                                     # Clear the content of the LTA text box.
        self.lineEdit_3.setText("")                                     # Clear the content of the ThrOn text box.
        self.lineEdit_4.setText("")                                     # Clear the content of the ThrOff text box.
        self.lineEdit_5.setText("0")                                    # Initialize Nº de Trace st[0] text box.
        self.lineEdit_6.setText("")                                     # Clear the content of the Frequency text box.
        self.lineEdit_7.setText("")                                     # Clear the content of the minimum frequency text box.
        self.lineEdit_8.setText("")                                     # Clear the content of the maximum frequency text box.
        self.lineEdit_9.setText("4")                                    # Initialize Filter order text box content = 4.


        # Enable and disable input text boxes.
        self.lineEdit.setEnabled(False)                                 # Disables the minimum STA text box.
        self.lineEdit_2.setEnabled(False)                               # Disables the minimum LTA text box.
        self.lineEdit_3.setEnabled(False)                               # Disables the minimum ThrOn text box.
        self.lineEdit_4.setEnabled(False)                               # Disables the minimum ThrOff text box.
        self.lineEdit_5.setEnabled(False)                               # Disable the Nº de Trace st[0] text box.
        self.lineEdit_6.setEnabled(False)                               # Disable the Frequency Text box.
        self.lineEdit_7.setEnabled(False)                               # Disables the Min Frecuency text box.
        self.lineEdit_8.setEnabled(False)                               # Disables the Max Frecuency text box.
        self.lineEdit_9.setEnabled(False)                               # Disable the Filter Order text box.


    def activacion2(self):                                              # To Activate / Deactivate and cleaning in Lowpass y Highpass

        plt.close()                                                     # Close the existing chart.

        # Clean entrances.
        self.lineEdit_5.setText("0")                                    # Initialize Nº de Trace st[0] text box.
        self.lineEdit_7.setText("")                                     # Clear the content of the minimum frequency text box.
        self.lineEdit_8.setText("")                                     # Clear the content of the maximum frequency text box.
        self.lineEdit_9.setText("4")                                    # Initialize Filter order text box content = 4.

        # Enable and disable input text boxes.
        self.lineEdit.setEnabled(True)                                  # Enable the minimum STA text box.
        self.lineEdit_2.setEnabled(True)                                # Enable the minimum LTA text box.
        self.lineEdit_3.setEnabled(True)                                # Enable the minimum ThrOn text box.
        self.lineEdit_4.setEnabled(True)                                # Enable the minimum ThrOff text box.
        self.lineEdit_5.setEnabled(True)                                # Enable the Nº de Trace st[0] text box.
        self.lineEdit_6.setEnabled(True)                                # Activate the Frequency Text box.
        self.lineEdit_7.setEnabled(False)                               # Disable the minimum frequency text box.
        self.lineEdit_8.setEnabled(False)                               # Disable the maximum frequency text box.
        self.lineEdit_9.setEnabled(True)                                # Activate the Filter Order text box.

        self.pushButton_5.setEnabled(True)                              # Enable el boton de Graficar.

    def activacion3(self):                  # To Activate / Deactivate and cleaning in Bandpass y Bandstop

        plt.close()                                                     # Close the existing chart.

        # Clean entrances.
        self.lineEdit_6.setText("")                                     # Clear the content of the Frequency text box.

        # Enable and disable input text boxes.
        self.lineEdit.setEnabled(True)                                  # Enable the minimum STA text box.
        self.lineEdit_2.setEnabled(True)                                # Enable the minimum LTA text box.
        self.lineEdit_3.setEnabled(True)                                # Enable the minimum ThrOn text box.
        self.lineEdit_4.setEnabled(True)                                # Enable the minimum ThrOff text box.
        self.lineEdit_5.setEnabled(True)                                # Enable the Nº de Trace st[0] text box.
        self.lineEdit_6.setEnabled(False)                               # Disable the Frequency Text box.
        self.lineEdit_7.setEnabled(True)                                # Activate the minimum frequency text box.
        self.lineEdit_8.setEnabled(True)                                # Activate the maximum frequency text box.
        self.lineEdit_9.setEnabled(True)                                # Activate the Filter Order text box.

        self.pushButton_5.setEnabled(True)                              # Enable el boton de Graficar.


    """  Function for the command button, which calculates and graphs the STA/LTA functions for the analysis with the filters.  """

    def verificar(self):                                                # FFunción para validar entradas y graficar los Filtros de Records

            index1 = self.comboBox_2.currentIndex()                     # Reading the ComboBox index

            if (1 == index1):                                           # Call to calculation function for lowpass filter
                self.filtropasobajo()
            elif (2 == index1):                                         # Call to calculation function for highpass filter
                self.filtropasoalto()
            elif (3 == index1):                                         # Call to calculation function for bandpass filter
                self.filtropasabanda()
            elif (4 == index1):                                         # Call to calculation function for bandstop filter
                self.filtrobandstop()

            else:
                pass

    """  *** Functions to perform signal analysis with filters (1-4) ***     """

    def filtropasobajo(self):                                           # 1.- Function to execute the Lowpass filter

            if self.radioButton.isChecked() == True:                    # Recursive Algorithm

                #try:
                # Check that the text boxes are not empty
                    if not self.lineEdit.text():
                        MensCombo1 = QMessageBox()
                        MensCombo1.setIcon(QMessageBox.Warning)
                        MensCombo1.setWindowTitle("STA Value Empty")
                        MensCombo1.setText("Please enter a valid value")
                        returnValue = MensCombo1.exec()

                    elif not self.lineEdit_2.text():
                        MensCombo2 = QMessageBox()
                        MensCombo2.setIcon(QMessageBox.Warning)
                        MensCombo2.setWindowTitle("LTA Value Empty")
                        MensCombo2.setText("Please enter a valid value")
                        returnValue = MensCombo2.exec()

                    elif not self.lineEdit_3.text():
                        MensCombo3 = QMessageBox()
                        MensCombo3.setIcon(QMessageBox.Warning)
                        MensCombo3.setWindowTitle("ThrOn Value Empty")
                        MensCombo3.setText("Please enter a valid value")
                        returnValue = MensCombo3.exec()

                    elif not self.lineEdit_4.text():
                        MensCombo4 = QMessageBox()
                        MensCombo4.setIcon(QMessageBox.Warning)
                        MensCombo4.setWindowTitle("ThrOff Value Empty")
                        MensCombo4.setText("Please enter a valid value")
                        returnValue = MensCombo4.exec()

                    elif not self.lineEdit_5.text():
                        MensCombo5 = QMessageBox()
                        MensCombo5.setIcon(QMessageBox.Warning)
                        MensCombo5.setWindowTitle("Empty Trace No.")
                        MensCombo5.setText("Please enter a valid value")
                        returnValue = MensCombo5.exec()

                    elif not self.lineEdit_6.text():
                        MensCombo6 = QMessageBox()
                        MensCombo6.setIcon(QMessageBox.Warning)
                        MensCombo6.setWindowTitle("Frequency Value Empty")
                        MensCombo6.setText("Please enter a valid value")
                        returnValue = MensCombo6.exec()

                    elif not self.lineEdit_9.text():
                        MensCombo7 = QMessageBox()
                        MensCombo7.setIcon(QMessageBox.Warning)
                        MensCombo7.setWindowTitle("Filter order Value Empty")
                        MensCombo7.setText("Please enter a valid value")
                        returnValue = MensCombo7.exec()

                    else:

                        plt.close()                                 # close the existing chart

                        archivoFil1 = (self.label_2.text())         # Reading the record label
                        NSTA = (self.lineEdit.text())               # Reading label STA record value
                        NLTA = (self.lineEdit_2.text())             # LReading label LTA record value
                        NThrOn = (self.lineEdit_3.text())           # Reading label ThrOn record value
                        NThrOff = (self.lineEdit_4.text())          # Reading label ThrOff record value

                        # Convert to float the string value of the text box
                        Valor1=float(NSTA)                          # Convert STA value to float
                        Valor2=float(NLTA)                          # Convert LTA value to float
                        Valor3=float(NThrOn)                        # Convert ThrOn value to float
                        Valor4=float(NThrOff)                       # Convert ThrOff value to float

                        frec1 = (self.lineEdit_6.text())            # Read label Frequency
                        orden1 = (self.lineEdit_9.text())           # Read Label Filter Order

                        # Convert to float the string value of the text box
                        frec2=float(frec1)                          # Convert the Frequency value to float
                        orden2=int(orden1)                          # Convert filter order value to integer

                        # To detect file extension through the path
                        st  = obspy.read(archivoFil1)               # Read file according record format

                        # Enter and convert to integer the string value of the No. Traces st[0] text box
                        NTraza = (self.lineEdit_5.text())           # Reading the content of the text box Trace No. st[0]
                        Ntraza2 = int(NTraza)                       # Converts the value of the Trace Number to integer
                        tr = st[Ntraza2]                            # Assigns the indicated trace number to the Stream for record processing

                        tr.stats.station

                        cabecera = st[Ntraza2].stats

                        tr_filt = tr.copy()
                        s = len(tr)

                        tr_filt.filter('lowpass', freq=frec2, corners=orden2, zerophase=True)
                        # Donde corners = orden del filtro, de orden 4
                        #tr_filt.filter('lowpass', freq=frec1, corners=4, zerophase=True)
                        # Calculation of the time vector
                        t = np.arange(0, tr.stats.npts / tr.stats.sampling_rate, tr.stats.delta)

                        cft = recursive_sta_lta(tr_filt.data, int(Valor1 * tr.stats.sampling_rate),
                        int(Valor2 * tr.stats.sampling_rate))

                        on_of = trigger_onset(cft, Valor3, Valor4)

                        #print('Valores', on_of[:, 0])
                        #print('Tamaño', len(on_of[:, 0]))

                        # Creación del fichero de texto (txt) para guardar valores de STA
                        # Creación del array para almacenar resultados
                        #R = np.array(on_of)[:,0]
                        #file = open("Sta_Results_Lowpass_File_Recursive.txt", "w")
                        #file.write("EQU STA Time Values \n")
                        #file.write(str(R) + os.linesep )
                        #file.write("EQU number: \n" )
                        #file.write(str(len(R)))
                        #file.close()

                        # Creación del fichero de texto (txt) para guardar valores de LTA
                        # Creación del array para almacenar resultados
                        #L = np.array(on_of)[:,1]
                        #Lfile = open("Lta_Results_Lowpass_File_Recursive.txt", "w")
                        #Lfile.write("EQU LTA Time Values \n")
                        #Lfile.write(str(L) + os.linesep )
                        #Lfile.write("EQU number: \n" )
                        #Lfile.write(str(len(L)))
                        #Lfile.close()

                        ax = plt.subplot(211)
                        plt.plot(tr_filt.data, 'k')                   # Where 'k' is the color = black
                        plt.ylabel('Filtered Record Lowpass', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left

                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'b'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Recursive Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                        plt.figure()        # Para Graficar Registro Original, Sin Filtro

                        ax = plt.subplot(211)
                        plt.plot(tr.data, 'k')                          # Where 'k' is the color = black
                        plt.ylabel('Original Record', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'k'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Recursive Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                #except:                                                 # In case of any error
                #        plt.close()                                     # close the existing chart
                #        msgBox = QMessageBox()
                #        msgBox.setIcon(QMessageBox.Warning)
                #        msgBox.setText("The File Doesn't exist, is Invalid or the Format is not recognized. please try again...")
                #        msgBox.setWindowTitle("Invalid Format Record or parameters values")
                #        returnValue = msgBox.exec()


            else:   # classic algorithm
                try:
                    plt.close()                                         # close the existing chart
                # Check that the text boxes are not empty
                    if not self.lineEdit.text():
                        MensCombo1 = QMessageBox()
                        MensCombo1.setIcon(QMessageBox.Warning)
                        MensCombo1.setWindowTitle("STA Value Empty")
                        MensCombo1.setText("Please enter a valid value")
                        returnValue = MensCombo1.exec()

                    elif not self.lineEdit_2.text():
                        MensCombo2 = QMessageBox()
                        MensCombo2.setIcon(QMessageBox.Warning)
                        MensCombo2.setWindowTitle("LTA Value Empty")
                        MensCombo2.setText("Please enter a valid value")
                        returnValue = MensCombo2.exec()

                    elif not self.lineEdit_3.text():
                        MensCombo3 = QMessageBox()
                        MensCombo3.setIcon(QMessageBox.Warning)
                        MensCombo3.setWindowTitle("ThrOn Value Empty")
                        MensCombo3.setText("Please enter a valid value")
                        returnValue = MensCombo3.exec()

                    elif not self.lineEdit_4.text():
                        MensCombo4 = QMessageBox()
                        MensCombo4.setIcon(QMessageBox.Warning)
                        MensCombo4.setWindowTitle("ThrOff Value Empty")
                        MensCombo4.setText("Please enter a valid value")
                        returnValue = MensCombo4.exec()

                    elif not self.lineEdit_5.text():
                        MensCombo5 = QMessageBox()
                        MensCombo5.setIcon(QMessageBox.Warning)
                        MensCombo5.setWindowTitle("Empty Trace No.")
                        MensCombo5.setText("Please enter a valid value")
                        returnValue = MensCombo5.exec()

                    elif not self.lineEdit_6.text():
                        MensCombo6 = QMessageBox()
                        MensCombo6.setIcon(QMessageBox.Warning)
                        MensCombo6.setWindowTitle("Frequency Value Empty")
                        MensCombo6.setText("Please enter a valid value")
                        returnValue = MensCombo6.exec()

                    elif not self.lineEdit_9.text():
                        MensCombo7 = QMessageBox()
                        MensCombo7.setIcon(QMessageBox.Warning)
                        MensCombo7.setWindowTitle("Filter order Value Empty")
                        MensCombo7.setText("Please enter a valid value")
                        returnValue = MensCombo7.exec()

                    else:

                        plt.close()                                 # close the existing chart

                        archivoFil1 = (self.label_2.text())         # Reading the record label
                        NSTA = (self.lineEdit.text())               # Reading label STA record value
                        NLTA = (self.lineEdit_2.text())             # LReading label LTA record value
                        NThrOn = (self.lineEdit_3.text())           # Reading label ThrOn record value
                        NThrOff = (self.lineEdit_4.text())          # Reading label ThrOff record value

                        # Convert to float the string value of the text box
                        Valor1=float(NSTA)                          # Convert STA value to float
                        Valor2=float(NLTA)                          # Convert LTA value to float
                        Valor3=float(NThrOn)                        # Convert ThrOn value to float
                        Valor4=float(NThrOff)                       # Convert ThrOff value to float

                        frec1 = (self.lineEdit_6.text())            # Read label Frequency
                        orden1 = (self.lineEdit_9.text())           # Read Label Filter Order

                        # Convert to float the string value of the text box
                        frec2=float(frec1)                          # Convert the Frequency value to float
                        orden2=int(orden1)                          # Convert filter order value to integer

                        # To detect file extension through the path

                        st  = obspy.read(archivoFil1)               # Read file according record format

                        # Enter and convert to integer the string value of the No. Traces st[0] text box
                        NTraza = (self.lineEdit_5.text())           # Reading the content of the text box Trace No. st[0]
                        Ntraza2 = int(NTraza)                       # Converts the value of the Trace Number to integer
                        tr = st[Ntraza2]                            # Assigns the indicated trace number to the Stream for record processing

                        tr.stats.station

                        cabecera = st[Ntraza2].stats

                        tr_filt = tr.copy()
                        s = len(tr)

                        tr_filt.filter('lowpass', freq=frec2, corners=orden2, zerophase=True)
                        # Donde corners = orden del filtro, de orden 4
                        #tr_filt.filter('lowpass', freq=frec1, corners=4, zerophase=True)
                        # Calculation of the time vector
                        t = np.arange(0, tr.stats.npts / tr.stats.sampling_rate, tr.stats.delta)

                        cft = classic_sta_lta(tr_filt.data, int(Valor1 * tr.stats.sampling_rate),
                        int(Valor2 * tr.stats.sampling_rate))

                        on_of = trigger_onset(cft, Valor3, Valor4)

                        #print('Valores', on_of[:, 0])
                        #print('Tamaño', len(on_of[:, 0]))

                        # Creación del fichero de texto (txt) para guardar valores de STA
                        # Creación del array para almacenar resultados
                        R1 = np.array(on_of)[:,0]
                        file1 = open("Sta_Results_Lowpass_File_Classic.txt", "w")
                        file1.write("EQU STA Time Values \n")
                        file1.write(str(R1) + os.linesep )
                        file1.write("EQU number: \n" )
                        file1.write(str(len(R1)))
                        file1.close()

                        # Creación del fichero de texto (txt) para guardar valores de LTA
                        # Creación del array para almacenar resultados
                        L1 = np.array(on_of)[:,1]
                        Lfile1 = open("Lta_Results_Lowpass_File_Classic.txt", "w")
                        Lfile1.write("EQU LTA Time Values \n")
                        Lfile1.write(str(L1) + os.linesep )
                        Lfile1.write("EQU number: \n" )
                        Lfile1.write(str(len(L1)))
                        Lfile1.close()

                        ax = plt.subplot(211)
                        plt.plot(tr_filt.data, 'k')                   # Where 'k' is the color = black
                        plt.ylabel('Filtered Record Lowpass', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')                              # Where 'k' is the color = black
                        plt.ylabel('Record umbral', color ="blue")
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'b'], linestyle='--')
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Classic or Typical Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                        plt.figure()         # Para Graficar Registro Original, Sin Filtro

                        ax = plt.subplot(211)
                        plt.plot(tr.data, 'k')                          # Where 'k' is the color = black
                        plt.ylabel('Original Record', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()


                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'k'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Classic or Typical Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()



                except:                                                 # In case of any error
                        plt.close()                                     # close the existing chart
                        msgBox = QMessageBox()
                        msgBox.setIcon(QMessageBox.Warning)
                        msgBox.setText("The File Doesn't exist, is Invalid or the Format is not recognized. please try again...")
                        msgBox.setWindowTitle("Invalid Format Record or parameters values")
                        returnValue = msgBox.exec()


    def filtropasoalto(self):                                           # 1.- Function to execute the highpass filter

            if self.radioButton.isChecked() == True:                    # Recursive Algorithm

                try:
                # Check that the text boxes are not empty
                    if not self.lineEdit.text():
                        MensCombo1 = QMessageBox()
                        MensCombo1.setIcon(QMessageBox.Warning)
                        MensCombo1.setWindowTitle("STA Value Empty")
                        MensCombo1.setText("Please enter a valid value")
                        returnValue = MensCombo1.exec()

                    elif not self.lineEdit_2.text():
                        MensCombo2 = QMessageBox()
                        MensCombo2.setIcon(QMessageBox.Warning)
                        MensCombo2.setWindowTitle("LTA Value Empty")
                        MensCombo2.setText("Please enter a valid value")
                        returnValue = MensCombo2.exec()

                    elif not self.lineEdit_3.text():
                        MensCombo3 = QMessageBox()
                        MensCombo3.setIcon(QMessageBox.Warning)
                        MensCombo3.setWindowTitle("ThrOn Value Empty")
                        MensCombo3.setText("Please enter a valid value")
                        returnValue = MensCombo3.exec()

                    elif not self.lineEdit_4.text():
                        MensCombo4 = QMessageBox()
                        MensCombo4.setIcon(QMessageBox.Warning)
                        MensCombo4.setWindowTitle("ThrOff Value Empty")
                        MensCombo4.setText("Please enter a valid value")
                        returnValue = MensCombo4.exec()

                    elif not self.lineEdit_5.text():
                        MensCombo5 = QMessageBox()
                        MensCombo5.setIcon(QMessageBox.Warning)
                        MensCombo5.setWindowTitle("Empty Trace No.")
                        MensCombo5.setText("Please enter a valid value")
                        returnValue = MensCombo5.exec()

                    elif not self.lineEdit_6.text():
                        MensCombo6 = QMessageBox()
                        MensCombo6.setIcon(QMessageBox.Warning)
                        MensCombo6.setWindowTitle("Frequency Value Empty")
                        MensCombo6.setText("Please enter a valid value")
                        returnValue = MensCombo6.exec()

                    elif not self.lineEdit_9.text():
                        MensCombo7 = QMessageBox()
                        MensCombo7.setIcon(QMessageBox.Warning)
                        MensCombo7.setWindowTitle("Filter order Value Empty")
                        MensCombo7.setText("Please enter a valid value")
                        returnValue = MensCombo7.exec()

                    else:

                        plt.close()                                 # close the existing chart

                        archivoFil1 = (self.label_2.text())         # Reading the record label
                        NSTA = (self.lineEdit.text())               # Reading label STA record value
                        NLTA = (self.lineEdit_2.text())             # LReading label LTA record value
                        NThrOn = (self.lineEdit_3.text())           # Reading label ThrOn record value
                        NThrOff = (self.lineEdit_4.text())          # Reading label ThrOff record value

                        # Convert to float the string value of the text box
                        Valor1=float(NSTA)                          # Convert STA value to float
                        Valor2=float(NLTA)                          # Convert LTA value to float
                        Valor3=float(NThrOn)                        # Convert ThrOn value to float
                        Valor4=float(NThrOff)                       # Convert ThrOff value to float

                        frec1 = (self.lineEdit_6.text())            # Read label Frequency
                        orden1 = (self.lineEdit_9.text())           # Read Label Filter Order

                        # Convert to float the string value of the text box
                        frec2=float(frec1)                          # Convert the Frequency value to float
                        orden2=int(orden1)                          # Convert filter order value to integer

                        # To detect file extension through the path
                        st  = obspy.read(archivoFil1)               # Read file according record format

                        # Enter and convert to integer the string value of the No. Traces st[0] text box
                        NTraza = (self.lineEdit_5.text())           # Reading the content of the text box Trace No. st[0]
                        Ntraza2 = int(NTraza)                       # Converts the value of the Trace Number to integer
                        tr = st[Ntraza2]                            # Assigns the indicated trace number to the Stream for record processing

                        tr.stats.station

                        cabecera = st[Ntraza2].stats

                        tr_filt = tr.copy()
                        s = len(tr)

                        tr_filt.filter('highpass', freq=frec2, corners=orden2, zerophase=True)
                        # Donde corners = orden del filtro, de orden 4
                        #tr_filt.filter('highpass', freq=frec1, corners=4, zerophase=True)
                        # Calculation of the time vector
                        t = np.arange(0, tr.stats.npts / tr.stats.sampling_rate, tr.stats.delta)

                        cft = recursive_sta_lta(tr_filt.data, int(Valor1 * tr.stats.sampling_rate),
                        int(Valor2 * tr.stats.sampling_rate))

                        on_of = trigger_onset(cft, Valor3, Valor4)

                        #print('Valores', on_of[:, 0])
                        #print('Tamaño', len(on_of[:, 0]))

                        # Creación del fichero de texto (txt) para guardar valores de STA
                        # Creación del array para almacenar resultados
                        R2 = np.array(on_of)[:,0]
                        file2 = open("Sta_Results_Highpass_File_Recursive.txt", "w")
                        file2.write("EQU STA Time Values \n")
                        file2.write(str(R2) + os.linesep )
                        file2.write("EQU number: \n" )
                        file2.write(str(len(R2)))
                        file2.close()

                        # Creación del fichero de texto (txt) para guardar valores de LTA
                        # Creación del array para almacenar resultados
                        L2 = np.array(on_of)[:,1]
                        Lfile2 = open("Lta_Results_Highpass_File_Recursive.txt", "w")
                        Lfile2.write("EQU LTA Time Values \n")
                        Lfile2.write(str(L2) + os.linesep )
                        Lfile2.write("EQU number: \n" )
                        Lfile2.write(str(len(L2)))
                        Lfile2.close()

                        ax = plt.subplot(211)
                        plt.plot(tr_filt.data, 'k')                   # Where 'k' is the color = black
                        plt.ylabel('Filtered Record highpass', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'b'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Recursive Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                        plt.figure()         # Para Graficar Registro Original, Sin Filtro

                        ax = plt.subplot(211)
                        plt.plot(tr.data, 'k')                          # Where 'k' is the color = black
                        plt.ylabel('Original Record', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'k'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Recursive Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                except:                                                 # In case of any error
                        plt.close()                                     # close the existing chart
                        msgBox = QMessageBox()
                        msgBox.setIcon(QMessageBox.Warning)
                        msgBox.setText("The File Doesn't exist, is Invalid or the Format is not recognized. please try again...")
                        msgBox.setWindowTitle("Invalid Format Record or parameters values")
                        returnValue = msgBox.exec()


            else:   # classic algorithm
                try:
                    plt.close()                                         # close the existing chart
                # Check that the text boxes are not empty
                    if not self.lineEdit.text():
                        MensCombo1 = QMessageBox()
                        MensCombo1.setIcon(QMessageBox.Warning)
                        MensCombo1.setWindowTitle("STA Value Empty")
                        MensCombo1.setText("Please enter a valid value")
                        returnValue = MensCombo1.exec()

                    elif not self.lineEdit_2.text():
                        MensCombo2 = QMessageBox()
                        MensCombo2.setIcon(QMessageBox.Warning)
                        MensCombo2.setWindowTitle("LTA Value Empty")
                        MensCombo2.setText("Please enter a valid value")
                        returnValue = MensCombo2.exec()

                    elif not self.lineEdit_3.text():
                        MensCombo3 = QMessageBox()
                        MensCombo3.setIcon(QMessageBox.Warning)
                        MensCombo3.setWindowTitle("ThrOn Value Empty")
                        MensCombo3.setText("Please enter a valid value")
                        returnValue = MensCombo3.exec()

                    elif not self.lineEdit_4.text():
                        MensCombo4 = QMessageBox()
                        MensCombo4.setIcon(QMessageBox.Warning)
                        MensCombo4.setWindowTitle("ThrOff Value Empty")
                        MensCombo4.setText("Please enter a valid value")
                        returnValue = MensCombo4.exec()

                    elif not self.lineEdit_5.text():
                        MensCombo5 = QMessageBox()
                        MensCombo5.setIcon(QMessageBox.Warning)
                        MensCombo5.setWindowTitle("Empty Trace No.")
                        MensCombo5.setText("Please enter a valid value")
                        returnValue = MensCombo5.exec()

                    elif not self.lineEdit_6.text():
                        MensCombo6 = QMessageBox()
                        MensCombo6.setIcon(QMessageBox.Warning)
                        MensCombo6.setWindowTitle("Frequency Value Empty")
                        MensCombo6.setText("Please enter a valid value")
                        returnValue = MensCombo6.exec()

                    elif not self.lineEdit_9.text():
                        MensCombo7 = QMessageBox()
                        MensCombo7.setIcon(QMessageBox.Warning)
                        MensCombo7.setWindowTitle("Filter order Value Empty")
                        MensCombo7.setText("Please enter a valid value")
                        returnValue = MensCombo7.exec()

                    else:

                        plt.close()                                 # close the existing chart

                        archivoFil1 = (self.label_2.text())         # Reading the record label
                        NSTA = (self.lineEdit.text())               # Reading label STA record value
                        NLTA = (self.lineEdit_2.text())             # LReading label LTA record value
                        NThrOn = (self.lineEdit_3.text())           # Reading label ThrOn record value
                        NThrOff = (self.lineEdit_4.text())          # Reading label ThrOff record value

                        # Convert to float the string value of the text box
                        Valor1=float(NSTA)                          # Convert STA value to float
                        Valor2=float(NLTA)                          # Convert LTA value to float
                        Valor3=float(NThrOn)                        # Convert ThrOn value to float
                        Valor4=float(NThrOff)                       # Convert ThrOff value to float

                        frec1 = (self.lineEdit_6.text())            # Read label Frequency
                        orden1 = (self.lineEdit_9.text())           # Read Label Filter Order

                        # Convert to float the string value of the text box
                        frec2=float(frec1)                          # Convert the Frequency value to float
                        orden2=int(orden1)                          # Convert filter order value to integer

                        # To detect file extension through the path

                        st  = obspy.read(archivoFil1)               # Read file according record format

                        # Enter and convert to integer the string value of the No. Traces st[0] text box
                        NTraza = (self.lineEdit_5.text())           # Reading the content of the text box Trace No. st[0]
                        Ntraza2 = int(NTraza)                       # Converts the value of the Trace Number to integer
                        tr = st[Ntraza2]                            # Assigns the indicated trace number to the Stream for record processing

                        tr.stats.station

                        cabecera = st[Ntraza2].stats

                        tr_filt = tr.copy()
                        s = len(tr)

                        tr_filt.filter('highpass', freq=frec2, corners=orden2, zerophase=True)
                        # Donde corners = orden del filtro, de orden 4
                        #tr_filt.filter('highpass', freq=frec1, corners=4, zerophase=True)
                        # Calculation of the time vector
                        t = np.arange(0, tr.stats.npts / tr.stats.sampling_rate, tr.stats.delta)

                        cft = classic_sta_lta(tr_filt.data, int(Valor1 * tr.stats.sampling_rate),
                        int(Valor2 * tr.stats.sampling_rate))

                        on_of = trigger_onset(cft, Valor3, Valor4)

                        #print('Valores', on_of[:, 0])
                        #print('Tamaño', len(on_of[:, 0]))

                        # Creación del fichero de texto (txt) para guardar valores de STA
                        # Creación del array para almacenar resultados
                        R3 = np.array(on_of)[:,0]
                        file3 = open("Sta_Results_Highpass_File_Classic.txt", "w")
                        file3.write("EQU STA Time Values \n")
                        file3.write(str(R3) + os.linesep )
                        file3.write("EQU number: \n" )
                        file3.write(str(len(R3)))
                        file3.close()

                        # Creación del fichero de texto (txt) para guardar valores de LTA
                        # Creación del array para almacenar resultados
                        L3 = np.array(on_of)[:,1]
                        Lfile3 = open("Lta_Results_Highpass_File_Classic.txt", "w")
                        Lfile3.write("EQU LTA Time Values \n")
                        Lfile3.write(str(L3) + os.linesep )
                        Lfile3.write("EQU number: \n" )
                        Lfile3.write(str(len(L3)))
                        Lfile3.close()

                        ax = plt.subplot(211)
                        plt.plot(tr_filt.data, 'k')                     # Where 'k' is the color = black
                        plt.ylabel('Filtered Record highpass', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')                              # Where 'k' is the color = black
                        plt.ylabel('Record umbral', color ="blue")
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'b'], linestyle='--')
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Classic or Typical Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                        plt.figure()         # Para Graficar Registro Original, Sin Filtro

                        ax = plt.subplot(211)
                        plt.plot(tr.data, 'k')                          # Where 'k' is the color = black
                        plt.ylabel('Original Record', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()


                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'k'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Classic or Typical Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                except:                                                 # In case of any error
                        plt.close()                                     # close the existing chart
                        msgBox = QMessageBox()
                        msgBox.setIcon(QMessageBox.Warning)
                        msgBox.setText("The File Doesn't exist, is Invalid or the Format is not recognized. please try again...")
                        msgBox.setWindowTitle("Invalid Format Record or parameters values")
                        returnValue = msgBox.exec()


    def filtropasabanda(self):                                          # 1.- Function to execute the bandpass filter

            if self.radioButton.isChecked() == True:                    # Recursive Algorithm

                #try:
                # Check that the text boxes are not empty
                    if not self.lineEdit.text():
                        MensCombo1 = QMessageBox()
                        MensCombo1.setIcon(QMessageBox.Warning)
                        MensCombo1.setWindowTitle("STA Value Empty")
                        MensCombo1.setText("Please enter a valid value")
                        returnValue = MensCombo1.exec()

                    elif not self.lineEdit_2.text():
                        MensCombo2 = QMessageBox()
                        MensCombo2.setIcon(QMessageBox.Warning)
                        MensCombo2.setWindowTitle("LTA Value Empty")
                        MensCombo2.setText("Please enter a valid value")
                        returnValue = MensCombo2.exec()

                    elif not self.lineEdit_3.text():
                        MensCombo3 = QMessageBox()
                        MensCombo3.setIcon(QMessageBox.Warning)
                        MensCombo3.setWindowTitle("ThrOn Value Empty")
                        MensCombo3.setText("Please enter a valid value")
                        returnValue = MensCombo3.exec()

                    elif not self.lineEdit_4.text():
                        MensCombo4 = QMessageBox()
                        MensCombo4.setIcon(QMessageBox.Warning)
                        MensCombo4.setWindowTitle("ThrOff Value Empty")
                        MensCombo4.setText("Please enter a valid value")
                        returnValue = MensCombo4.exec()

                    elif not self.lineEdit_5.text():
                        MensCombo5 = QMessageBox()
                        MensCombo5.setIcon(QMessageBox.Warning)
                        MensCombo5.setWindowTitle("Empty Trace No.")
                        MensCombo5.setText("Please enter a valid value")
                        returnValue = MensCombo5.exec()

                    elif not self.lineEdit_7.text():
                        MensCombo6 = QMessageBox()
                        MensCombo6.setIcon(QMessageBox.Warning)
                        MensCombo6.setWindowTitle("Min. Frec. Value Empty")
                        MensCombo6.setText("Please enter a valid value")
                        returnValue = MensCombo6.exec()

                    elif not self.lineEdit_8.text():
                        MensCombo7 = QMessageBox()
                        MensCombo7.setIcon(QMessageBox.Warning)
                        MensCombo7.setWindowTitle("Max. Frec. Value Empty")
                        MensCombo7.setText("Please enter a valid value")
                        returnValue = MensCombo7.exec()

                    elif not self.lineEdit_9.text():
                        MensCombo8 = QMessageBox()
                        MensCombo8.setIcon(QMessageBox.Warning)
                        MensCombo8.setWindowTitle("Filter order Value Empty")
                        MensCombo8.setText("Please enter a valid value")
                        returnValue = MensCombo8.exec()

                    else:

                        plt.close()                                 # close the existing chart

                        archivoFil1 = (self.label_2.text())         # Reading the record label
                        NSTA = (self.lineEdit.text())               # Reading label STA record value
                        NLTA = (self.lineEdit_2.text())             # LReading label LTA record value
                        NThrOn = (self.lineEdit_3.text())           # Reading label ThrOn record value
                        NThrOff = (self.lineEdit_4.text())          # Reading label ThrOff record value

                        # Convert to float the string value of the text box
                        Valor1=float(NSTA)                          # Convert STA value to float
                        Valor2=float(NLTA)                          # Convert LTA value to float
                        Valor3=float(NThrOn)                        # Convert ThrOn value to float
                        Valor4=float(NThrOff)                       # Convert ThrOff value to float

                        frecM = (self.lineEdit_7.text())            # Read Frec. Min. Label
                        frecMax = (self.lineEdit_8.text())          # Read Frec. Max. Label

                        orden1 = (self.lineEdit_9.text())           # Read Label Filter Order

                        # Convert to float the string value of the text box
                        frec7=float(frecM)                          # Convert the Min. Frequency value to float.
                        frec8=float(frecMax)                        # Convert the Max. Frequency value to float.

                        orden2=int(orden1)                          # Convert filter order value to integer

                        # To detect file extension through the path
                        st  = obspy.read(archivoFil1)               # Read file according record format

                        # Enter and convert to integer the string value of the No. Traces st[0] text box
                        NTraza = (self.lineEdit_5.text())           # Reading the content of the text box Trace No. st[0]
                        Ntraza2 = int(NTraza)                       # Converts the value of the Trace Number to integer
                        tr = st[Ntraza2]                            # Assigns the indicated trace number to the Stream for record processing

                        tr.stats.station

                        cabecera = st[Ntraza2].stats

                        tr_filt = tr.copy()
                        s = len(tr)

                        tr_filt.filter('bandpass', freqmin=frec7, freqmax=frec8, corners=orden2, zerophase=True)
                        # Donde corners = orden del filtro, de orden 4
                        #tr_filt.filter('bandpass', freqmin=frec7, freqmax=frec8, corners=orden7, zerophase=True)

                        # Calculation of the time vector
                        t = np.arange(0, tr.stats.npts / tr.stats.sampling_rate, tr.stats.delta)

                        cft = recursive_sta_lta(tr_filt.data, int(Valor1 * tr.stats.sampling_rate),
                        int(Valor2 * tr.stats.sampling_rate))

                        on_of = trigger_onset(cft, Valor3, Valor4)

                        #print('Valores', on_of[:, 0])
                        #print('Tamaño', len(on_of[:, 0]))

                        # Creación del fichero de texto (txt) para guardar valores de STA
                        # Creación del array para almacenar resultados
                        R4 = np.array(on_of)[:,0]
                        file4 = open("Sta_Results_Bandpass_File_Recursive.txt", "a+")
                        file4.write("EQU STA Time Values \n")
                        file4.write(str(R4) + os.linesep )
                        file4.write("EQU number: \n" )
                        file4.write(str(len(R4)))
                        file4.close()

                        # Creación del fichero de texto (txt) para guardar valores de LTA
                        # Creación del array para almacenar resultados
                        L4 = np.array(on_of)[:,1]
                        Lfile4 = open("Lta_Results_Bandpass_File_Recursive.txt", "a+")
                        Lfile4.write("EQU LTA Time Values \n")
                        Lfile4.write(str(L4) + os.linesep )
                        Lfile4.write("EQU number: \n" )
                        Lfile4.write(str(len(L4)))
                        file4.close()

                        ax = plt.subplot(211)
                        plt.plot(tr_filt.data, 'k')                   # Where 'k' is the color = black
                        plt.ylabel('Filtered Record bandpass', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'b'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Recursive Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                        plt.figure()         # Para Graficar Registro Original, Sin Filtro

                        ax = plt.subplot(211)
                        plt.plot(tr.data, 'k')                          # Where 'k' is the color = black
                        plt.ylabel('Original Record', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()


                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'k'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Recursive Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                #except:                                                 # In case of any error
                #        plt.close()                                     # close the existing chart
                #        msgBox = QMessageBox()
                #        msgBox.setIcon(QMessageBox.Warning)
                #        msgBox.setText("The File Doesn't exist, is Invalid or the Format is not recognized. please try again...")
                #        msgBox.setWindowTitle("Invalid Format Record or parameters values")
                #        returnValue = msgBox.exec()


            else:   # classic algorithm
                try:
                    plt.close()                                         # close the existing chart
                # Check that the text boxes are not empty
                    if not self.lineEdit.text():
                        MensCombo1 = QMessageBox()
                        MensCombo1.setIcon(QMessageBox.Warning)
                        MensCombo1.setWindowTitle("STA Value Empty")
                        MensCombo1.setText("Please enter a valid value")
                        returnValue = MensCombo1.exec()

                    elif not self.lineEdit_2.text():
                        MensCombo2 = QMessageBox()
                        MensCombo2.setIcon(QMessageBox.Warning)
                        MensCombo2.setWindowTitle("LTA Value Empty")
                        MensCombo2.setText("Please enter a valid value")
                        returnValue = MensCombo2.exec()

                    elif not self.lineEdit_3.text():
                        MensCombo3 = QMessageBox()
                        MensCombo3.setIcon(QMessageBox.Warning)
                        MensCombo3.setWindowTitle("ThrOn Value Empty")
                        MensCombo3.setText("Please enter a valid value")
                        returnValue = MensCombo3.exec()

                    elif not self.lineEdit_4.text():
                        MensCombo4 = QMessageBox()
                        MensCombo4.setIcon(QMessageBox.Warning)
                        MensCombo4.setWindowTitle("ThrOff Value Empty")
                        MensCombo4.setText("Please enter a valid value")
                        returnValue = MensCombo4.exec()

                    elif not self.lineEdit_5.text():
                        MensCombo5 = QMessageBox()
                        MensCombo5.setIcon(QMessageBox.Warning)
                        MensCombo5.setWindowTitle("Empty Trace No.")
                        MensCombo5.setText("Please enter a valid value")
                        returnValue = MensCombo5.exec()

                    elif not self.lineEdit_7.text():
                        MensCombo6 = QMessageBox()
                        MensCombo6.setIcon(QMessageBox.Warning)
                        MensCombo6.setWindowTitle("Min. Frec. Value Empty")
                        MensCombo6.setText("Please enter a valid value")
                        returnValue = MensCombo6.exec()

                    elif not self.lineEdit_8.text():
                        MensCombo7 = QMessageBox()
                        MensCombo7.setIcon(QMessageBox.Warning)
                        MensCombo7.setWindowTitle("Max. Frec. Value Empty")
                        MensCombo7.setText("Please enter a valid value")
                        returnValue = MensCombo7.exec()

                    elif not self.lineEdit_9.text():
                        MensCombo8 = QMessageBox()
                        MensCombo8.setIcon(QMessageBox.Warning)
                        MensCombo8.setWindowTitle("Filter order Value Empty")
                        MensCombo8.setText("Please enter a valid value")
                        returnValue = MensCombo8.exec()

                    else:

                        plt.close()                                 # close the existing chart


                        archivoFil1 = (self.label_2.text())         # Reading the record label
                        NSTA = (self.lineEdit.text())               # Reading label STA record value
                        NLTA = (self.lineEdit_2.text())             # LReading label LTA record value
                        NThrOn = (self.lineEdit_3.text())           # Reading label ThrOn record value
                        NThrOff = (self.lineEdit_4.text())          # Reading label ThrOff record value

                        # Convert to float the string value of the text box
                        Valor1=float(NSTA)                          # Convert STA value to float
                        Valor2=float(NLTA)                          # Convert LTA value to float
                        Valor3=float(NThrOn)                        # Convert ThrOn value to float
                        Valor4=float(NThrOff)                       # Convert ThrOff value to float

                        frecM = (self.lineEdit_7.text())            # Read Frec. Min. Label
                        frecMax = (self.lineEdit_8.text())          # Read Frec. Max. Label

                        orden1 = (self.lineEdit_9.text())           # Read Label Filter Order

                        # Convert to float the string value of the text box
                        frec7=float(frecM)                          # Convert the Min. Frequency value to float.
                        frec8=float(frecMax)                        # CConvert the Max. Frequency value to float.

                        orden2=int(orden1)                          # Convert filter order value to integer

                        # To detect file extension through the path
                        st  = obspy.read(archivoFil1)               # Read file according record format

                        # Enter and convert to integer the string value of the No. Traces st[0] text box
                        NTraza = (self.lineEdit_5.text())           # Reading the content of the text box Trace No. st[0]
                        Ntraza2 = int(NTraza)                       # Converts the value of the Trace Number to integer
                        tr = st[Ntraza2]                            # Assigns the indicated trace number to the Stream for record processing

                        tr.stats.station

                        cabecera = st[Ntraza2].stats

                        tr_filt = tr.copy()
                        s = len(tr)

                        tr_filt.filter('bandpass', freqmin=frec7, freqmax=frec8, corners=orden2, zerophase=True)
                        # Donde corners = orden del filtro, de orden 4
                        #tr_filt.filter('bandpass', freqmin=frec7, freqmax=frec8, corners=orden7, zerophase=True)

                        # Calculation of the time vector
                        t = np.arange(0, tr.stats.npts / tr.stats.sampling_rate, tr.stats.delta)

                        cft = classic_sta_lta(tr_filt.data, int(Valor1 * tr.stats.sampling_rate),
                        int(Valor2 * tr.stats.sampling_rate))

                        on_of = trigger_onset(cft, Valor3, Valor4)

                        #print('Valores', on_of[:, 0])
                        #print('Tamaño', len(on_of[:, 0]))

                        # Creación del fichero de texto (txt) para guardar valores de STA
                        # Creación del array para almacenar resultados
                        R5 = np.array(on_of)[:,0]
                        file5 = open("Sta_Results_Bandpass_File_Classic.txt", "w")
                        file5.write("EQU STA Time Values \n")
                        file5.write(str(R5) + os.linesep )
                        file5.write("EQU number: \n" )
                        file5.write(str(len(R5)))
                        file5.close()

                        # Creación del fichero de texto (txt) para guardar valores de LTA
                        # Creación del array para almacenar resultados
                        L5 = np.array(on_of)[:,1]
                        Lfile5 = open("Lta_Results_Bandpass_File_Classic.txt", "w")
                        Lfile5.write("EQU LTA Time Values \n")
                        Lfile5.write(str(L5) + os.linesep )
                        Lfile5.write("EQU number: \n" )
                        Lfile5.write(str(len(L5)))
                        Lfile5.close()

                        ax = plt.subplot(211)
                        plt.plot(tr_filt.data, 'k')                   # Where 'k' is the color = black
                        plt.ylabel('Filtered Record bandpass', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')                              # Where 'k' is the color = black
                        plt.ylabel('Record umbral', color ="blue")
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'b'], linestyle='--')
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Classic or Typical Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                        plt.figure()         # Para Graficar Registro Original, Sin Filtro

                        ax = plt.subplot(211)
                        plt.plot(tr.data, 'k')                          # Where 'k' is the color = black
                        plt.ylabel('Original Record', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'k'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Classic or Typical Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                except:                                                 # In case of any error
                        plt.close()                                     # close the existing chart
                        msgBox = QMessageBox()
                        msgBox.setIcon(QMessageBox.Warning)
                        msgBox.setText("The File Doesn't exist, is Invalid or the Format is not recognized. please try again...")
                        msgBox.setWindowTitle("Invalid Format Record or parameters values")
                        returnValue = msgBox.exec()

    def filtrobandstop(self):                                          # 1.- Function to execute the bandstop filter

            if self.radioButton.isChecked() == True:                    # Recursive Algorithm

                try:
                # Check that the text boxes are not empty
                    if not self.lineEdit.text():
                        MensCombo1 = QMessageBox()
                        MensCombo1.setIcon(QMessageBox.Warning)
                        MensCombo1.setWindowTitle("STA Value Empty")
                        MensCombo1.setText("Please enter a valid value")
                        returnValue = MensCombo1.exec()

                    elif not self.lineEdit_2.text():
                        MensCombo2 = QMessageBox()
                        MensCombo2.setIcon(QMessageBox.Warning)
                        MensCombo2.setWindowTitle("LTA Value Empty")
                        MensCombo2.setText("Please enter a valid value")
                        returnValue = MensCombo2.exec()

                    elif not self.lineEdit_3.text():
                        MensCombo3 = QMessageBox()
                        MensCombo3.setIcon(QMessageBox.Warning)
                        MensCombo3.setWindowTitle("ThrOn Value Empty")
                        MensCombo3.setText("Please enter a valid value")
                        returnValue = MensCombo3.exec()

                    elif not self.lineEdit_4.text():
                        MensCombo4 = QMessageBox()
                        MensCombo4.setIcon(QMessageBox.Warning)
                        MensCombo4.setWindowTitle("ThrOff Value Empty")
                        MensCombo4.setText("Please enter a valid value")
                        returnValue = MensCombo4.exec()

                    elif not self.lineEdit_5.text():
                        MensCombo5 = QMessageBox()
                        MensCombo5.setIcon(QMessageBox.Warning)
                        MensCombo5.setWindowTitle("Empty Trace No.")
                        MensCombo5.setText("Please enter a valid value")
                        returnValue = MensCombo5.exec()

                    elif not self.lineEdit_7.text():
                        MensCombo6 = QMessageBox()
                        MensCombo6.setIcon(QMessageBox.Warning)
                        MensCombo6.setWindowTitle("Min. Frec. Value Empty")
                        MensCombo6.setText("Please enter a valid value")
                        returnValue = MensCombo6.exec()

                    elif not self.lineEdit_8.text():
                        MensCombo7 = QMessageBox()
                        MensCombo7.setIcon(QMessageBox.Warning)
                        MensCombo7.setWindowTitle("Max. Frec. Value Empty")
                        MensCombo7.setText("Please enter a valid value")
                        returnValue = MensCombo7.exec()

                    elif not self.lineEdit_9.text():
                        MensCombo8 = QMessageBox()
                        MensCombo8.setIcon(QMessageBox.Warning)
                        MensCombo8.setWindowTitle("Filter order Value Empty")
                        MensCombo8.setText("Please enter a valid value")
                        returnValue = MensCombo8.exec()

                    else:

                        plt.close()                                 # close the existing chart

                        archivoFil1 = (self.label_2.text())         # Reading the record label
                        NSTA = (self.lineEdit.text())               # Reading label STA record value
                        NLTA = (self.lineEdit_2.text())             # LReading label LTA record value
                        NThrOn = (self.lineEdit_3.text())           # Reading label ThrOn record value
                        NThrOff = (self.lineEdit_4.text())          # Reading label ThrOff record value

                        # Convert to float the string value of the text box
                        Valor1=float(NSTA)                          # Convert STA value to float
                        Valor2=float(NLTA)                          # Convert LTA value to float
                        Valor3=float(NThrOn)                        # Convert ThrOn value to float
                        Valor4=float(NThrOff)                       # Convert ThrOff value to float

                        frecM = (self.lineEdit_7.text())            # Read Frec. Min. Label
                        frecMax = (self.lineEdit_8.text())          # Read Frec. Max. Label

                        orden1 = (self.lineEdit_9.text())           # Read Label Filter Order

                        # Convert to float the string value of the text box
                        frec7=float(frecM)                          # Convert the Min. Frequency value to float.
                        frec8=float(frecMax)                        # Convert the Max. Frequency value to float.

                        orden2=int(orden1)                          # Convert filter order value to integer

                        # To detect file extension through the path
                        st  = obspy.read(archivoFil1)               # Read file according record format

                        # Enter and convert to integer the string value of the No. Traces st[0] text box
                        NTraza = (self.lineEdit_5.text())           # Reading the content of the text box Trace No. st[0]
                        Ntraza2 = int(NTraza)                       # Converts the value of the Trace Number to integer
                        tr = st[Ntraza2]                            # Assigns the indicated trace number to the Stream for record processing

                        tr.stats.station

                        cabecera = st[Ntraza2].stats

                        tr_filt = tr.copy()
                        s = len(tr)

                        tr_filt.filter('bandstop', freqmin=frec7, freqmax=frec8, corners=orden2, zerophase=True)
                        # Donde corners = orden del filtro, de orden 4
                        #tr_filt.filter('bandstop', freqmin=frec7, freqmax=frec8, corners=orden7, zerophase=True)

                        # Calculation of the time vector
                        t = np.arange(0, tr.stats.npts / tr.stats.sampling_rate, tr.stats.delta)

                        cft = recursive_sta_lta(tr_filt.data, int(Valor1 * tr.stats.sampling_rate),
                        int(Valor2 * tr.stats.sampling_rate))

                        on_of = trigger_onset(cft, Valor3, Valor4)

                        #print('Valores', on_of[:, 0])
                        #print('Tamaño', len(on_of[:, 0]))

                        # Creación del fichero de texto (txt) para guardar valores de STA
                        # Creación del array para almacenar resultados
                        R6 = np.array(on_of)[:,0]
                        file6 = open("Sta_Lta_Results_Bandstop_File_Recursive.txt", "w")
                        file6.write("EQU STA Time Values \n")
                        file6.write(str(R6) + os.linesep )
                        file6.write("EQU number: \n" )
                        file6.write(str(len(R6)))
                        file6.close()

                        # Creación del fichero de texto (txt) para guardar valores de LTA
                        # Creación del array para almacenar resultados
                        L6 = np.array(on_of)[:,1]
                        Lfile6 = open("Lta_Results_Bandstop_File_Recursive.txt", "w")
                        Lfile6.write("EQU LTA Time Values \n")
                        Lfile6.write(str(L6) + os.linesep )
                        Lfile6.write("EQU number: \n" )
                        Lfile6.write(str(len(L6)))
                        Lfile6.close()

                        ax = plt.subplot(211)
                        plt.plot(tr_filt.data, 'k')                   # Where 'k' is the color = black
                        plt.ylabel('Filtered Record bandstop', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'b'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Recursive Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                        plt.figure()         # Para Graficar Registro Original, Sin Filtro

                        ax = plt.subplot(211)
                        plt.plot(tr.data, 'k')                          # Where 'k' is the color = black
                        plt.ylabel('Original Record', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'k'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Recursive Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                except:                                                 # In case of any error
                        plt.close()                                     # close the existing chart
                        msgBox = QMessageBox()
                        msgBox.setIcon(QMessageBox.Warning)
                        msgBox.setText("The File Doesn't exist, is Invalid or the Format is not recognized. please try again...")
                        msgBox.setWindowTitle("Invalid Format Record or parameters values")
                        returnValue = msgBox.exec()


            else:   # classic algorithm
                try:
                    plt.close()                                         # close the existing chart
                # Check that the text boxes are not empty
                    if not self.lineEdit.text():
                        MensCombo1 = QMessageBox()
                        MensCombo1.setIcon(QMessageBox.Warning)
                        MensCombo1.setWindowTitle("STA Value Empty")
                        MensCombo1.setText("Please enter a valid value")
                        returnValue = MensCombo1.exec()

                    elif not self.lineEdit_2.text():
                        MensCombo2 = QMessageBox()
                        MensCombo2.setIcon(QMessageBox.Warning)
                        MensCombo2.setWindowTitle("LTA Value Empty")
                        MensCombo2.setText("Please enter a valid value")
                        returnValue = MensCombo2.exec()

                    elif not self.lineEdit_3.text():
                        MensCombo3 = QMessageBox()
                        MensCombo3.setIcon(QMessageBox.Warning)
                        MensCombo3.setWindowTitle("ThrOn Value Empty")
                        MensCombo3.setText("Please enter a valid value")
                        returnValue = MensCombo3.exec()

                    elif not self.lineEdit_4.text():
                        MensCombo4 = QMessageBox()
                        MensCombo4.setIcon(QMessageBox.Warning)
                        MensCombo4.setWindowTitle("ThrOff Value Empty")
                        MensCombo4.setText("Please enter a valid value")
                        returnValue = MensCombo4.exec()

                    elif not self.lineEdit_5.text():
                        MensCombo5 = QMessageBox()
                        MensCombo5.setIcon(QMessageBox.Warning)
                        MensCombo5.setWindowTitle("Empty Trace No.")
                        MensCombo5.setText("Please enter a valid value")
                        returnValue = MensCombo5.exec()

                    elif not self.lineEdit_7.text():
                        MensCombo6 = QMessageBox()
                        MensCombo6.setIcon(QMessageBox.Warning)
                        MensCombo6.setWindowTitle("Min. Frec. Value Empty")
                        MensCombo6.setText("Please enter a valid value")
                        returnValue = MensCombo6.exec()

                    elif not self.lineEdit_8.text():
                        MensCombo7 = QMessageBox()
                        MensCombo7.setIcon(QMessageBox.Warning)
                        MensCombo7.setWindowTitle("Max. Frec. Value Empty")
                        MensCombo7.setText("Please enter a valid value")
                        returnValue = MensCombo7.exec()

                    elif not self.lineEdit_9.text():
                        MensCombo8 = QMessageBox()
                        MensCombo8.setIcon(QMessageBox.Warning)
                        MensCombo8.setWindowTitle("Filter order Value Empty")
                        MensCombo8.setText("Please enter a valid value")
                        returnValue = MensCombo8.exec()

                    else:

                        plt.close()                                 # close the existing chart

                        archivoFil1 = (self.label_2.text())         # Reading the record label
                        NSTA = (self.lineEdit.text())               # Reading label STA record value
                        NLTA = (self.lineEdit_2.text())             # LReading label LTA record value
                        NThrOn = (self.lineEdit_3.text())           # Reading label ThrOn record value
                        NThrOff = (self.lineEdit_4.text())          # Reading label ThrOff record value

                        # Convert to float the string value of the text box
                        Valor1=float(NSTA)                          # Convert STA value to float
                        Valor2=float(NLTA)                          # Convert LTA value to float
                        Valor3=float(NThrOn)                        # Convert ThrOn value to float
                        Valor4=float(NThrOff)                       # Convert ThrOff value to float

                        frecM = (self.lineEdit_7.text())            # Read Frec. Min. Label
                        frecMax = (self.lineEdit_8.text())          # Read Frec. Max. Label

                        orden1 = (self.lineEdit_9.text())           # Read Label Filter Order

                        # Convert to float the string value of the text box
                        frec7=float(frecM)                          # Convert the Min. Frequency value to float.
                        frec8=float(frecMax)                        # CConvert the Max. Frequency value to float.

                        orden2=int(orden1)                          # Convert filter order value to integer

                        # To detect file extension through the path
                        st  = obspy.read(archivoFil1)               # Read file according record format

                        # Enter and convert to integer the string value of the No. Traces st[0] text box
                        NTraza = (self.lineEdit_5.text())           # Reading the content of the text box Trace No. st[0]
                        Ntraza2 = int(NTraza)                       # Converts the value of the Trace Number to integer
                        tr = st[Ntraza2]                            # Assigns the indicated trace number to the Stream for record processing

                        tr.stats.station

                        cabecera = st[Ntraza2].stats

                        tr_filt = tr.copy()
                        s = len(tr)

                        tr_filt.filter('bandstop', freqmin=frec7, freqmax=frec8, corners=orden2, zerophase=True)
                        # Donde corners = orden del filtro, de orden 4
                        #tr_filt.filter('bandstop', freqmin=frec7, freqmax=frec8, corners=orden7, zerophase=True)

                        # Calculation of the time vector
                        t = np.arange(0, tr.stats.npts / tr.stats.sampling_rate, tr.stats.delta)

                        cft = classic_sta_lta(tr_filt.data, int(Valor1 * tr.stats.sampling_rate),
                        int(Valor2 * tr.stats.sampling_rate))

                        on_of = trigger_onset(cft, Valor3, Valor4)

                        #print('Valores', on_of[:, 0])
                        #print('Tamaño', len(on_of[:, 0]))

                        # Creación del fichero de texto (txt) para guardar valores de STA
                        # Creación del array para almacenar resultados
                        R7 = np.array(on_of)[:,0]
                        file7 = open("Sta_Results_Bandstop_File_Classic.txt", "w")
                        file7.write("EQU STA Time Values \n")
                        file7.write(str(R7) + os.linesep )
                        file7.write("EQU number: \n" )
                        file7.write(str(len(R7)))
                        file7.close()

                        # Creación del fichero de texto (txt) para guardar valores de LTA
                        # Creación del array para almacenar resultados
                        L7 = np.array(on_of)[:,1]
                        Lfile7 = open("Lta_Results_Bandstop_File_Classic.txt", "w")
                        Lfile7.write("EQU LTA Time Values \n")
                        Lfile7.write(str(L7) + os.linesep )
                        Lfile7.write("EQU number: \n" )
                        Lfile7.write(str(len(L7)))
                        Lfile7.close()

                        ax = plt.subplot(211)
                        plt.plot(tr_filt.data, 'k')                   # Where 'k' is the color = black
                        plt.ylabel('Filtered Record bandstop', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()

                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')                              # Where 'k' is the color = black
                        plt.ylabel('Record umbral', color ="blue")
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'b'], linestyle='--')
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Classic or Typical Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()

                        plt.figure()         # Para Graficar Registro Original, Sin Filtro

                        ax = plt.subplot(211)
                        plt.plot(tr.data, 'k')                          # Where 'k' is the color = black
                        plt.ylabel('Original Record', color ="blue")
                        ymin, ymax = ax.get_ylim()
                        ax.vlines(on_of[:, 0], ymin, ymax, color='r', linewidth=2, label='Trigger On')
                        ax.vlines(on_of[:, 1], ymin, ymax, color='b', linewidth=2, label='Trigger Off')
                        ax.legend(prop = {'size': 10}, loc='upper right', ncol=1)      # To place the legend on the left
                        plt.grid()
                        plt.show()


                        plt.subplot(212, sharex=ax)
                        plt.plot(cft, 'k')
                        plt.hlines([Valor3, Valor4], 0, len(cft), color=['r', 'k'], linestyle='--')
                        plt.ylabel('Record umbral', color ="blue")
                        plt.legend()
                        plt.axis('tight')
                        plt.xlabel('Time [s]', color ="red")
                        plt.title(u'STA/LTA Classic or Typical Record', color ="darkgreen")  # We put a title
                        plt.suptitle("Record : %s " % tr.stats.starttime, color ="red")
                        plt.grid()                                      # display the plot grid
                        plt.show()



                except:                                                 # In case of any error
                        plt.close()                                     # close the existing chart
                        msgBox = QMessageBox()
                        msgBox.setIcon(QMessageBox.Warning)
                        msgBox.setText("The File Doesn't exist, is Invalid or the Format is not recognized. please try again...")
                        msgBox.setWindowTitle("Invalid Format Record or parameters values")
                        returnValue = msgBox.exec()


    """ Function to go back at home """

    def return1(self):   # Call function to another program (Back) - Menu
        if sistema == "Windows":                                        # If the system is Windows
            plt.close()                                                 # Close the existing chart.
            subprocess.Popen(["python", "Menu.py"])
            app.quit()
            #print("We are in {}".format(sistema))
        else:                                                           # If the system is Linux
            plt.close()                                                 # Close the existing chart
            subprocess.Popen(["python3", "Menu.py"])
            app.quit()



    """  Fuction to exit system  """

    def Exit1(self):    # Function to show exit dialog box
        msg = QMessageBox()
        msg.setIcon(QMessageBox.Question)
        msg.setWindowTitle("Exit Module 2 - STA/LTA")
        msg.setText("Are you sure to exit the Module 2 and System?")
        msg.setStandardButtons(QMessageBox.Ok | QMessageBox.Cancel)
        msg.setDefaultButton(QMessageBox.Ok)                                # By default, the focus is on the OK button
        returnValue = msg.exec()
        if returnValue == QMessageBox.Ok:                                   # If the answer is OK
            app.closeAllWindows()                                           # Close all windows



if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
    # Developed by: Ligdamis A. Gutiérrez E. PhD.
